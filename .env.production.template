# =============================================================================
# MechaMap Realtime Server - Production Configuration Template
# =============================================================================
# Copy this file to .env.production and update the values for your production environment

# Server Configuration
NODE_ENV=production
PORT=3000
HOST=0.0.0.0

# SSL Configuration (Nginx handles SSL termination)
SSL_ENABLED=false
SSL_CERT_PATH=/etc/letsencrypt/live/realtime.mechamap.com/fullchain.pem
SSL_KEY_PATH=/etc/letsencrypt/live/realtime.mechamap.com/privkey.pem

# Database Configuration (MySQL) - Production Database
DB_HOST=localhost
DB_PORT=3306
DB_NAME=mechamap
DB_USER=mechamap_user
DB_PASSWORD=your_production_db_password_here
DB_CONNECTION_LIMIT=20
DB_TIMEOUT=60000

# Redis Configuration (Optional - for session storage)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password_here
REDIS_DB=0
REDIS_PREFIX=mechamap_realtime:

# JWT Configuration - MUST match Laravel's JWT secret
JWT_SECRET=your_production_jwt_secret_here

# Laravel Integration (Production)
# CHANGE THIS: Your Laravel production domain
LARAVEL_API_URL=https://mechamap.com
# GENERATE NEW: Get this from Laravel websocket:generate-api-key command
LARAVEL_API_KEY=your_production_laravel_api_key_here
LARAVEL_DB_CONNECTION=true

# CORS Configuration (Production)
# CHANGE THIS: Your production domains
CORS_ORIGIN=https://mechamap.com,https://www.mechamap.com
CORS_CREDENTIALS=true

# Admin Configuration
ADMIN_KEY=your-super-secure-admin-key-production

# Rate Limiting (More restrictive for production)
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=200
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# WebSocket Configuration
WS_PING_TIMEOUT=60000
WS_PING_INTERVAL=25000
WS_MAX_HTTP_BUFFER_SIZE=1e6
WS_TRANSPORTS=websocket,polling
WS_UPGRADE_TIMEOUT=10000

# Connection Limits (Higher for production)
MAX_CONNECTIONS=50000
MAX_CONNECTIONS_PER_USER=10
CONNECTION_TIMEOUT=30000
HEARTBEAT_INTERVAL=25000

# Logging Configuration (Less verbose for production)
LOG_LEVEL=info
LOG_FILE=/var/log/mechamap/realtime.log
LOG_MAX_SIZE=50m
LOG_MAX_FILES=10
LOG_DATE_PATTERN=YYYY-MM-DD

# Monitoring & Health Checks
MONITORING_ENABLED=true
METRICS_RETENTION_HOURS=168
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000
PROMETHEUS_METRICS=true

# Alert Configuration
ALERT_WEBHOOK_URL=https://your-monitoring-webhook.com/alerts
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/your/slack/webhook

# Performance Tuning (Production optimized)
CLUSTER_ENABLED=true
CLUSTER_WORKERS=max
MEMORY_LIMIT=2048
GC_INTERVAL=300000

# Security (Enhanced for production)
HELMET_ENABLED=true
COMPRESSION_ENABLED=true
TRUST_PROXY=true

# Production Settings
DEBUG_MODE=false
VERBOSE_LOGGING=false
MOCK_LARAVEL_API=false

# Performance Monitoring
UV_THREADPOOL_SIZE=128
NODE_OPTIONS=--max-old-space-size=2048

# Alert Thresholds
ALERT_CONNECTIONS_MAX=10000
ALERT_CONNECTIONS_CRITICAL=40000
ALERT_RESPONSE_TIME_MAX=500
ALERT_RESPONSE_TIME_CRITICAL=1000
ALERT_ERROR_RATE_MAX=0.05
ALERT_ERROR_RATE_CRITICAL=0.10
ALERT_MEMORY_MAX=0.80
ALERT_MEMORY_CRITICAL=0.90

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_INTERVAL=24h
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=mechamap-backups
BACKUP_S3_REGION=ap-southeast-1

# Load Balancing (if using multiple instances)
LOAD_BALANCER_ENABLED=false
STICKY_SESSIONS=true
SESSION_STORE=redis

# CDN Configuration (if using CDN for static assets)
CDN_URL=https://cdn.mechamap.com
STATIC_ASSETS_CDN=true

# External Services
ELASTICSEARCH_URL=http://localhost:9200
ELASTICSEARCH_INDEX=mechamap_realtime

# Notification Services
PUSH_NOTIFICATION_ENABLED=true
FCM_SERVER_KEY=your_fcm_server_key
APNS_KEY_ID=your_apns_key_id
APNS_TEAM_ID=your_apns_team_id

# Analytics
ANALYTICS_ENABLED=true
GOOGLE_ANALYTICS_ID=your_ga_tracking_id

# Feature Flags
FEATURE_CHAT_ENABLED=true
FEATURE_VOICE_CHAT_ENABLED=false
FEATURE_VIDEO_CHAT_ENABLED=false
FEATURE_FILE_SHARING_ENABLED=true
FEATURE_SCREEN_SHARING_ENABLED=false
